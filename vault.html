<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Schola Arcana ‚Äî Proof Vault</title>
  <meta name="description" content="A pink, aesthetic Proof Vault: 17 weekly LaTeX proof artifacts + master proof. Searchable, filterable, and locally check-offable." />
  <style>
    :root{
      --bg:#fff7fb;
      --card:#ffffffcc;
      --ink:#1f1630;
      --muted:#5b4b66;

      --pink:#ff4da6;
      --pink2:#ff77c2;
      --lav:#b18cff;
      --mint:#5fe2c2;
      --gold:#ffd36e;

      --line:#f2c9df;
      --shadow: 0 18px 40px rgba(31,22,48,.10);
      --shadow2: 0 10px 24px rgba(31,22,48,.08);

      --radius:22px;
      --radius2:16px;

      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--ink);
      background:
        radial-gradient(1200px 700px at 10% 10%, #ffe0f0 0%, transparent 60%),
        radial-gradient(1000px 700px at 90% 20%, #f0e3ff 0%, transparent 55%),
        radial-gradient(900px 600px at 50% 90%, #e6fff7 0%, transparent 60%),
        linear-gradient(180deg, var(--bg) 0%, #ffffff 100%);
      overflow-x:hidden;
    }
    a{color:inherit}
    .wrap{max-width:1200px;margin:0 auto;padding:26px 18px 70px}
    .hero{
      position:relative;
      border:1px solid var(--line);
      border-radius:var(--radius);
      background: linear-gradient(135deg, #ffffffcc, #fff0f8cc);
      box-shadow:var(--shadow);
      padding:24px 22px;
      overflow:hidden;
    }
    .hero:before{
      content:"";
      position:absolute; inset:-45px -70px auto auto;
      width:320px;height:320px;
      background:
        radial-gradient(circle at 30% 30%, #ffb3da 0%, transparent 58%),
        radial-gradient(circle at 70% 70%, #c7b0ff 0%, transparent 58%);
      filter: blur(2px);
      transform: rotate(14deg);
      opacity:.9;
      pointer-events:none;
    }
    .sparkle{
      display:inline-block;
      background: linear-gradient(135deg, var(--pink), var(--lav));
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
      font-weight:950;
      letter-spacing:-.01em;
    }
    .hero h1{
      margin:0 0 8px;
      font-size: clamp(26px, 3.0vw, 42px);
      letter-spacing:-.02em;
      line-height:1.05;
    }
    .muted{color:var(--muted)}
    .row{display:flex;flex-wrap:wrap;gap:10px;align-items:center;margin-top:12px}
    .badge{
      border:1px solid var(--line);
      background:#fff;
      border-radius:999px;
      padding:8px 12px;
      font-size:13px;
      color:var(--muted);
      display:flex; gap:8px; align-items:center;
      box-shadow:0 8px 18px rgba(31,22,48,.06);
    }
    .dot{width:8px;height:8px;border-radius:50%}
    .dot.pink{background:var(--pink)}
    .dot.lav{background:var(--lav)}
    .dot.mint{background:var(--mint)}
    .dot.gold{background:var(--gold)}

    .btn{
      border:1px solid var(--line);
      background: linear-gradient(180deg, #fff, #fff7fb);
      border-radius:999px;
      padding:10px 14px;
      font-weight:900;
      font-size:13px;
      cursor:pointer;
      box-shadow:0 10px 18px rgba(31,22,48,.06);
      transition: transform .08s ease, border-color .2s ease;
      user-select:none;
    }
    .btn:hover{transform: translateY(-1px); border-color:#f0a7cd}
    .btn.primary{
      border-color: transparent;
      background: linear-gradient(135deg, var(--pink), var(--pink2));
      color:white;
    }
    .btn.ghost{background:transparent; box-shadow:none;}
    .pill{
      font-family:var(--mono);
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background:#fff;
      color:var(--muted);
      white-space:nowrap;
    }

    .controls{
      margin-top:14px;
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap:12px;
    }
    @media (max-width: 980px){ .controls{grid-template-columns:1fr} }

    .card{
      border:1px solid var(--line);
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow2);
      padding:14px;
      backdrop-filter: blur(8px);
    }
    .card h2{
      margin:0 0 10px;
      font-size:16px;
      letter-spacing:-.01em;
      display:flex; align-items:center; gap:10px;
    }

    .searchRow{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .search{flex:1 1 320px; position:relative}
    .search input{
      width:100%;
      padding:12px 12px 12px 40px;
      border-radius:999px;
      border:1px solid var(--line);
      background:#fff;
      outline:none;
      box-shadow:0 10px 18px rgba(31,22,48,.06);
      font-size:14px;
    }
    .search input:focus{border-color:#f0a7cd}
    .searchIcon{
      position:absolute; left:14px; top:50%; transform:translateY(-50%);
      width:16px;height:16px; opacity:.55;
      border:2px solid var(--muted); border-radius:50%;
    }
    .searchIcon:after{
      content:"";
      position:absolute; width:9px; height:2px; background:var(--muted);
      bottom:-6px; right:-7px; transform: rotate(45deg);
      border-radius:2px;
      opacity:.8;
    }

    .filterRow{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-top:10px}
    .chip{
      display:inline-flex; align-items:center; gap:8px;
      border:1px solid var(--line);
      background:#fff;
      padding:7px 10px;
      border-radius:999px;
      font-size:12px;
      color:var(--muted);
      cursor:pointer;
      user-select:none;
      transition:.12s ease;
      box-shadow:0 10px 18px rgba(31,22,48,.05);
    }
    .chip[aria-pressed="true"]{
      background: linear-gradient(135deg, #ffe2f2, #f2e8ff);
      border-color:#f0a7cd;
      color:#3a2449;
    }
    .chip b{color:var(--ink)}
    .tiny{font-size:12px;color:var(--muted);line-height:1.5}

    .vault{
      margin-top:14px;
      display:grid;
      grid-template-columns: 1fr 360px;
      gap:12px;
      align-items:start;
    }
    @media (max-width: 1100px){ .vault{grid-template-columns:1fr} }

    .panel{
      border:1px solid var(--line);
      background:#fff;
      border-radius:var(--radius);
      box-shadow:var(--shadow2);
      overflow:hidden;
    }

    .gridCards{
      padding:14px;
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    @media (max-width: 820px){ .gridCards{grid-template-columns:1fr} }

    .proofCard{
      border:1px solid #f7d8e8;
      border-radius:18px;
      background:#fff;
      box-shadow:0 10px 20px rgba(31,22,48,.06);
      padding:12px;
      display:flex;
      flex-direction:column;
      gap:10px;
      position:relative;
      overflow:hidden;
    }
    .proofCard:before{
      content:"";
      position:absolute; inset:auto -40px -40px auto;
      width:140px;height:140px;
      background:
        radial-gradient(circle at 30% 30%, #ffe2f2 0%, transparent 60%),
        radial-gradient(circle at 70% 70%, #f2e8ff 0%, transparent 60%);
      transform: rotate(16deg);
      opacity:.9;
      pointer-events:none;
    }
    .topline{
      display:flex; align-items:flex-start; justify-content:space-between; gap:10px;
    }
    .wk{
      font-family:var(--mono);
      font-weight:950;
      color:#3a2449;
      font-size:12px;
    }
    .title{
      margin:0;
      font-weight:950;
      letter-spacing:-.01em;
      font-size:14px;
      line-height:1.25;
    }
    .metaRow{display:flex;gap:6px;flex-wrap:wrap;align-items:center}
    .tag{
      font-family:var(--mono);
      font-size:11px;
      padding:5px 9px;
      border-radius:999px;
      border:1px solid var(--line);
      background:#fff7fb;
      color:var(--muted);
      white-space:nowrap;
    }
    .tag.lav{background:#f4eeff}
    .tag.mint{background:#edfffb}
    .tag.gold{background:#fff7e1}

    .desc{margin:0;color:var(--muted);font-size:12px;line-height:1.45}
    .actions{
      display:flex; gap:8px; flex-wrap:wrap; align-items:center;
      margin-top:auto;
    }
    .smallBtn{
      border:1px solid var(--line);
      background:#fff;
      border-radius:14px;
      padding:8px 10px;
      font-weight:900;
      font-size:12px;
      cursor:pointer;
      box-shadow:0 10px 18px rgba(31,22,48,.05);
      transition:.1s ease;
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      gap:8px;
    }
    .smallBtn:hover{transform: translateY(-1px); border-color:#f0a7cd}
    .smallBtn.primary{
      border-color: transparent;
      background: linear-gradient(135deg, var(--pink), var(--pink2));
      color:#fff;
    }
    .check{
      display:flex; align-items:center; gap:8px;
      font-size:12px; color:var(--muted);
      user-select:none;
    }
    .check input{accent-color: var(--pink); width:16px; height:16px}

    .sidebar{
      position:sticky;
      top:12px;
      border:1px solid var(--line);
      background: var(--card);
      border-radius:var(--radius);
      box-shadow:var(--shadow2);
      padding:14px;
      backdrop-filter: blur(8px);
    }
    .sidebar h3{margin:0 0 10px;font-size:15px;letter-spacing:-.01em}
    .stat{
      border:1px solid var(--line);
      background:#fff;
      border-radius:18px;
      padding:12px;
      margin-bottom:10px;
      box-shadow:0 10px 18px rgba(31,22,48,.05);
    }
    .stat .label{font-size:12px;color:var(--muted);margin-bottom:6px}
    .stat .value{font-weight:950;font-size:18px}
    .stat .sub{font-size:12px;color:var(--muted);margin-top:4px;line-height:1.45}
    .kbd{
      font-family:var(--mono);
      font-size:12px;
      background:#fff7fb;
      border:1px solid var(--line);
      padding:2px 6px;
      border-radius:8px;
      color:#3a2449;
    }
    footer{
      margin-top:16px;
      color:var(--muted);
      font-size:12px;
      text-align:center;
      line-height:1.55;
    }
    @media print{
      .controls,.sidebar,.row{display:none !important}
      body{background:#fff}
      .hero,.panel{box-shadow:none}
      .proofCard{box-shadow:none}
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header class="hero">
      <h1><span class="sparkle">Schola Arcana</span> ‚Äî Proof Vault</h1>
      <p class="muted" style="margin:0;max-width:92ch">
        A dedicated page for your <b>weekly LaTeX proof artifacts</b>. This is where your semester becomes
        admissions-grade: clean PDFs, consistent naming, and evidence of proof maturity.
      </p>

      <div class="row">
        <div class="badge"><span class="dot pink"></span> 1 proof artifact / week</div>
        <div class="badge"><span class="dot lav"></span> Proofs + reductions + linear algebra theorems</div>
        <div class="badge"><span class="dot mint"></span> Check-off saved locally (no login)</div>
        <div class="badge"><span class="dot gold"></span> Print-friendly</div>
      </div>

      <div class="row" style="margin-top:12px">
        <a class="btn ghost" href="index.html">‚Üê Back to Cathedral Semester</a>
        <button class="btn primary" id="exportProgress">Export progress</button>
        <button class="btn" id="resetProgress">Reset checks</button>
        <button class="btn ghost" id="printBtn">Print / PDF</button>
      </div>
    </header>

    <section class="controls">
      <div class="card">
        <h2>Search & filter <span class="pill">proof index</span></h2>
        <div class="searchRow">
          <div class="search">
            <span class="searchIcon" aria-hidden="true"></span>
            <input id="q" type="text" placeholder="Search: pumping lemma, reduction, rank-nullity, spectral theorem, Grover..." />
          </div>
          <button class="btn" id="copyLink">Copy share link</button>
        </div>

        <div class="filterRow">
          <div class="chip" role="button" tabindex="0" data-filter="toc" aria-pressed="false"><b>TOC</b></div>
          <div class="chip" role="button" tabindex="0" data-filter="logic" aria-pressed="false"><b>Logic</b></div>
          <div class="chip" role="button" tabindex="0" data-filter="discrete" aria-pressed="false"><b>Discrete</b></div>
          <div class="chip" role="button" tabindex="0" data-filter="linalg" aria-pressed="false"><b>Linear Algebra</b></div>
          <div class="chip" role="button" tabindex="0" data-filter="prob" aria-pressed="false"><b>Probability</b></div>
          <div class="chip" role="button" tabindex="0" data-filter="qc" aria-pressed="false"><b>Quantum</b></div>
          <div class="chip" role="button" tabindex="0" data-filter="meta" aria-pressed="false"><b>Synthesis</b></div>
        </div>

        <p class="tiny" style="margin:10px 0 0">
          Naming convention suggestion:
          <span class="kbd">proofs/week-07_cfl-pumping-lemma.pdf</span> (or .tex alongside).<br/>
          Keyboard: <span class="kbd">/</span> focuses search ‚Ä¢ <span class="kbd">Esc</span> clears search
        </p>
      </div>

      <div class="card">
        <h2>Folder layout <span class="pill">clean repo</span></h2>
        <div class="tiny" style="line-height:1.75">
          Put your files in your repo like:
          <div style="margin-top:8px">
            <span class="kbd">/proofs/</span><br/>
            <span class="kbd">/proofs/week-01_logic-implication-proof.pdf</span><br/>
            <span class="kbd">/proofs/week-02_nfa-equivalence.pdf</span><br/>
            <span class="kbd">/proofs/week-17_master-proof.pdf</span>
          </div>
          <div style="margin-top:10px">
            Then set each card‚Äôs link to the matching path (already pre-filled below).
          </div>
        </div>
      </div>
    </section>

    <section class="vault">
      <div class="panel">
        <div class="gridCards" id="cards"></div>
      </div>

      <aside class="sidebar">
        <h3>Vault stats</h3>
        <div class="stat">
          <div class="label">Completed artifacts</div>
          <div class="value" id="doneCount">‚Äî</div>
          <div class="sub">Checked items are saved in your browser (localStorage).</div>
        </div>
        <div class="stat">
          <div class="label">Visible artifacts</div>
          <div class="value" id="visibleCount">‚Äî</div>
          <div class="sub">Based on search + filters.</div>
        </div>
        <div class="stat">
          <div class="label">Total artifacts</div>
          <div class="value" id="totalCount">‚Äî</div>
          <div class="sub">One per week + final synthesis.</div>
        </div>
        <div class="stat">
          <div class="label">Pro tip</div>
          <div class="sub">
            Every proof should have a 1‚Äì3 sentence header: <b>statement</b>, <b>strategy</b>, <b>key lemma/invariant</b>.
          </div>
        </div>
      </aside>
    </section>

    <footer>
      Save as <span class="kbd">vault.html</span> (not <span class="kbd">.hmtl</span> üíÄ). Link it from your index CTA row.
    </footer>
  </div>

  <script>
    // ==========
    // DATA MODEL
    // ==========
    // You can edit titles/notes freely. Links point to /proofs/... in the same repo.
    const PROOFS = [
      { week: 1, lane: ["logic","foundations"], tag:"Logic", type:"Proof", title:"Implication vs equivalence ‚Äî a clean proof template",
        note:"A short proof artifact demonstrating: direct proof + contrapositive (and correct quantifier language).",
        file:"proofs/week-01_logic-implication-proof.pdf" },

      { week: 2, lane: ["toc"], tag:"TOC", type:"Proof", title:"NFA ‚â° DFA (subset construction) ‚Äî correctness argument",
        note:"State the theorem, give the invariant: set-of-states meaning, then prove both directions.",
        file:"proofs/week-02_nfa-dfa-equivalence.pdf" },

      { week: 3, lane: ["toc","logic"], tag:"TOC", type:"Proof", title:"Closure proof (regular languages) ‚Äî pick one and do it properly",
        note:"Union/concat/star/complement. Choose one and write a crisp construction + correctness.",
        file:"proofs/week-03_regular-closure-proof.pdf" },

      { week: 4, lane: ["toc"], tag:"TOC", type:"Proof", title:"Pumping lemma (regular) ‚Äî a full ‚Äòshow-not-regular‚Äô proof",
        note:"Write the strategy: assume regular, choose w, split, pump, contradiction.",
        file:"proofs/week-04_pumping-lemma-regular.pdf" },

      { week: 5, lane: ["linalg"], tag:"LA", type:"Theorem", title:"Rank‚Äìnullity theorem ‚Äî statement + proof",
        note:"Linear map viewpoint. This screams ‚ÄòAxler student‚Äô in the best way.",
        file:"proofs/week-05_rank-nullity.pdf" },

      { week: 6, lane: ["discrete"], tag:"Discrete", type:"Proof", title:"Combinatorial identity ‚Äî prove by bijection/double counting",
        note:"Pick a binomial identity and prove it by counting the same set two ways.",
        file:"proofs/week-06_combinatorial-proof.pdf" },

      { week: 7, lane: ["toc"], tag:"TOC", type:"Proof", title:"Pumping lemma (CFL) ‚Äî full non-CFL proof",
        note:"Choose a canonical language (like {a^n b^n c^n}) and do the case split cleanly.",
        file:"proofs/week-07_pumping-lemma-cfl.pdf" },

      { week: 8, lane: ["toc"], tag:"TOC", type:"Proof", title:"Turing machine ‚Äî language recognition or decidability proof (one crisp artifact)",
        note:"Build a decider/recognizer and prove correctness. Keep it sharp.",
        file:"proofs/week-08_tm-proof.pdf" },

      { week: 9, lane: ["prob"], tag:"Prob", type:"Proof", title:"Kolmogorov axioms ‚Üí derive a basic consequence",
        note:"E.g., P(A‚à™B)=P(A)+P(B)‚àíP(A‚à©B). Do it rigorously.",
        file:"proofs/week-09_probability-axioms.pdf" },

      { week: 10, lane: ["toc"], tag:"TOC", type:"Reduction", title:"Halting problem (A_TM) ‚Äî undecidability proof via reduction/diagonalization",
        note:"Write the mapping reduction clearly. This is ‚Äòfoundations of limits‚Äô energy.",
        file:"proofs/week-10_halting-undecidable.pdf" },

      { week: 11, lane: ["linalg","qc"], tag:"LA/QC", type:"Theorem", title:"Spectral theorem (selected form) ‚Äî statement + meaning for QC",
        note:"Even a clean ‚Äòfinite-dimensional normal operator‚Äô sketch is powerful (keep it honest).",
        file:"proofs/week-11_spectral-theorem.pdf" },

      { week: 12, lane: ["toc"], tag:"TOC", type:"Proof", title:"P vs NP framing ‚Äî NP verifiers & a clean example proof (SAT in NP)",
        note:"Write the verifier idea and prove correctness in a precise way.",
        file:"proofs/week-12_np-verifier-sat-in-np.pdf" },

      { week: 13, lane: ["toc"], tag:"TOC", type:"Reduction", title:"NP-completeness reduction ‚Äî 3SAT ‚â§p CLIQUE (or your favorite)",
        note:"Construction + correctness (iff) + polynomial bound. Clean template.",
        file:"proofs/week-13_np-reduction.pdf" },

      { week: 14, lane: ["prob","discrete"], tag:"Prob", type:"Proof", title:"Markov chains ‚Äî stationary distribution for a small chain (with proof)",
        note:"Show œÄP=œÄ and justify existence/intuition for your example.",
        file:"proofs/week-14_markov-stationary.pdf" },

      { week: 15, lane: ["analysis"], tag:"Analysis", type:"Proof", title:"Limits/convergence ‚Äî one real analysis proof (selective)",
        note:"E.g., show a sequence is Cauchy ‚áí convergent in ‚Ñù (outline) or a compactness consequence (taste).",
        file:"proofs/week-15_analysis-proof.pdf" },

      { week: 16, lane: ["meta","qc"], tag:"Synthesis", type:"Essay", title:"Shor‚Äôs algorithm ‚Äî a 2-page conceptual proof-sketch of why period finding helps",
        note:"Not full Shor. A clear conceptual chain: QFT ‚Üí period ‚Üí factoring.",
        file:"proofs/week-16_shor-concept.pdf" },

      { week: 17, lane: ["meta"], tag:"Synthesis", type:"Master", title:"Master proof artifact ‚Äî your best work (signature)",
        note:"Pick the strongest piece: a reduction, a theorem, or a synthesis proof. Make it admissions-ready.",
        file:"proofs/week-17_master-proof.pdf" },
    ];

    // ==========
    // STATE
    // ==========
    const STORAGE_KEY = "schola_arcana_proof_vault_checks_v1";
    const filterState = new Set();
    let query = "";

    function loadChecks(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        if(!raw) return {};
        return JSON.parse(raw);
      }catch{ return {}; }
    }
    function saveChecks(obj){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(obj));
    }

    const checks = loadChecks();

    // ==========
    // UI refs
    // ==========
    const cardsEl = document.getElementById("cards");
    const doneCountEl = document.getElementById("doneCount");
    const visibleCountEl = document.getElementById("visibleCount");
    const totalCountEl = document.getElementById("totalCount");
    const qInput = document.getElementById("q");

    // ==========
    // helpers
    // ==========
    function escapeHtml(s){
      return String(s).replace(/[&<>"']/g, (c)=>({ "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;" }[c]));
    }
    function highlight(text, q){
      if(!q) return escapeHtml(text);
      const re = new RegExp(`(${q.replace(/[.*+?^${}()|[\]\\]/g, "\\$&")})`, "ig");
      return escapeHtml(text).replace(re, "<mark style='background:linear-gradient(135deg,#ffe2f2,#f2e8ff);padding:0 2px;border-radius:6px'>$1</mark>");
    }

    function matchesFilters(p){
      if(!filterState.size) return true;
      return p.lane.some(x => filterState.has(x));
    }
    function matchesQuery(p){
      if(!query) return true;
      const q = query.toLowerCase();
      return (
        String(p.week).includes(q) ||
        p.title.toLowerCase().includes(q) ||
        p.note.toLowerCase().includes(q) ||
        p.type.toLowerCase().includes(q) ||
        p.tag.toLowerCase().includes(q) ||
        p.file.toLowerCase().includes(q)
      );
    }

    function iconFor(type){
      if(type==="Reduction") return "‚Üò";
      if(type==="Theorem") return "‚àé";
      if(type==="Essay") return "‚úé";
      if(type==="Master") return "‚úß";
      return "‚úì";
    }

    function render(){
      const total = PROOFS.length;
      totalCountEl.textContent = String(total);

      let done = 0;
      for(const p of PROOFS){
        if(checks[p.week]) done++;
      }
      doneCountEl.textContent = `${done} / ${total}`;

      const visible = PROOFS.filter(p => matchesFilters(p) && matchesQuery(p));
      visibleCountEl.textContent = String(visible.length);

      cardsEl.innerHTML = visible.map(p => {
        const checked = !!checks[p.week];
        const fileLabel = p.file.split("/").pop();
        return `
          <article class="proofCard" data-week="${p.week}">
            <div class="topline">
              <div>
                <div class="wk">W${String(p.week).padStart(2,"0")} ¬∑ ${escapeHtml(p.tag)} ¬∑ ${escapeHtml(p.type)} ${iconFor(p.type)}</div>
                <h3 class="title">${highlight(p.title, query)}</h3>
              </div>
              <label class="check" title="Mark as done (saved locally)">
                <input type="checkbox" ${checked ? "checked" : ""} data-check="${p.week}" />
                done
              </label>
            </div>

            <div class="metaRow">
              <span class="tag">${escapeHtml(fileLabel)}</span>
              ${p.lane.includes("toc") ? `<span class="tag lav">Sipser-coded</span>` : ""}
              ${p.lane.includes("linalg") ? `<span class="tag mint">Axler-coded</span>` : ""}
              ${p.lane.includes("qc") ? `<span class="tag gold">Quantum thread</span>` : ""}
            </div>

            <p class="desc">${highlight(p.note, query)}</p>

            <div class="actions">
              <a class="smallBtn primary" href="${escapeHtml(p.file)}" target="_blank" rel="noreferrer">Open PDF</a>
              <button class="smallBtn" data-copy="${escapeHtml(p.file)}">Copy path</button>
              <button class="smallBtn" data-cite="${p.week}">Copy citation</button>
            </div>
          </article>
        `;
      }).join("");

      // bind checkboxes
      document.querySelectorAll("input[data-check]").forEach(cb=>{
        cb.addEventListener("change", ()=>{
          const w = Number(cb.getAttribute("data-check"));
          checks[w] = cb.checked;
          saveChecks(checks);
          renderCountsOnly();
        });
      });

      // bind copy path
      document.querySelectorAll("button[data-copy]").forEach(btn=>{
        btn.addEventListener("click", async ()=>{
          const path = btn.getAttribute("data-copy");
          await safeCopy(path, btn);
        });
      });

      // bind citation
      document.querySelectorAll("button[data-cite]").forEach(btn=>{
        btn.addEventListener("click", async ()=>{
          const w = Number(btn.getAttribute("data-cite"));
          const p = PROOFS.find(x=>x.week===w);
          const cite = `Schola Arcana Proof Vault ‚Äî Week ${w}: "${p.title}". File: ${p.file}`;
          await safeCopy(cite, btn);
        });
      });
    }

    function renderCountsOnly(){
      const total = PROOFS.length;
      let done = 0;
      for(const p of PROOFS){ if(checks[p.week]) done++; }
      doneCountEl.textContent = `${done} / ${total}`;
    }

    async function safeCopy(text, btn){
      try{
        await navigator.clipboard.writeText(text);
        const old = btn.textContent;
        btn.textContent = "Copied ‚ú®";
        setTimeout(()=>btn.textContent = old, 900);
      }catch{
        alert("Could not copy automatically. You can manually copy from the PDF path in the card.");
      }
    }

    // ==========
    // filters
    // ==========
    function toggleChip(el){
      const key = el.getAttribute("data-filter");
      const pressed = el.getAttribute("aria-pressed") === "true";
      el.setAttribute("aria-pressed", pressed ? "false" : "true");
      if(pressed) filterState.delete(key);
      else filterState.add(key);
      render();
      syncUrl();
    }
    document.querySelectorAll(".chip[data-filter]").forEach(ch=>{
      ch.addEventListener("click", ()=>toggleChip(ch));
      ch.addEventListener("keydown", (e)=>{
        if(e.key==="Enter" || e.key===" "){ e.preventDefault(); toggleChip(ch); }
      });
    });

    // ==========
    // search
    // ==========
    qInput.addEventListener("input", ()=>{
      query = qInput.value.trim();
      render();
      syncUrl();
    });
    window.addEventListener("keydown", (e)=>{
      if(e.key==="/"){
        if(document.activeElement !== qInput){
          e.preventDefault();
          qInput.focus();
        }
      }
      if(e.key==="Escape"){
        if(document.activeElement === qInput || qInput.value){
          qInput.value = "";
          query = "";
          render();
          syncUrl();
        }
      }
    });

    // ==========
    // share link
    // ==========
    function syncUrl(){
      const params = new URLSearchParams();
      if(query) params.set("q", query);
      if(filterState.size) params.set("f", Array.from(filterState).join(","));
      const newUrl = `${location.pathname}?${params.toString()}`;
      history.replaceState(null, "", newUrl);
    }
    function loadUrl(){
      const params = new URLSearchParams(location.search);
      const q = params.get("q");
      const f = params.get("f");
      if(q){ query = q; qInput.value = q; }
      if(f){
        f.split(",").map(s=>s.trim()).filter(Boolean).forEach(x=>filterState.add(x));
        document.querySelectorAll(".chip[data-filter]").forEach(c=>{
          const key = c.getAttribute("data-filter");
          c.setAttribute("aria-pressed", filterState.has(key) ? "true" : "false");
        });
      }
    }
    document.getElementById("copyLink").onclick = async ()=>{
      await safeCopy(location.href, document.getElementById("copyLink"));
    };

    // ==========
    // export/reset/print
    // ==========
    document.getElementById("exportProgress").onclick = async ()=>{
      const doneWeeks = PROOFS.filter(p=>checks[p.week]).map(p=>p.week);
      const payload = {
        exported_at: new Date().toISOString(),
        completed_weeks: doneWeeks,
        total: PROOFS.length
      };
      await safeCopy(JSON.stringify(payload, null, 2), document.getElementById("exportProgress"));
    };

    document.getElementById("resetProgress").onclick = ()=>{
      if(confirm("Reset all checkmarks? This only clears local browser progress.")){
        for(const k of Object.keys(checks)) delete checks[k];
        saveChecks(checks);
        render();
      }
    };

    document.getElementById("printBtn").onclick = ()=>window.print();

    // ==========
    // boot
    // ==========
    loadUrl();
    render();
  </script>
</body>
</html>