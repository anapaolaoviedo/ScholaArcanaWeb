<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Schola Arcana ‚Äî Weekly & Daily Log</title>
  <meta name="description" content="Weekly + daily reflection system for the Cathedral Semester: what I learned, what I didn't understand, questions, revisits, mood, energy, and proof artifacts." />

  <style>
    :root{
      --bg:#fff7fb;
      --bg2:#ffe9f4;
      --card:#ffffffcc;
      --ink:#1f1630;
      --muted:#5b4b66;
      --pink:#ff4da6;
      --pink2:#ff77c2;
      --lav:#b18cff;
      --mint:#5fe2c2;
      --line:#f2c9df;
      --shadow: 0 18px 40px rgba(31,22,48,.10);
      --shadow2: 0 10px 24px rgba(31,22,48,.08);
      --radius: 22px;
      --radius2: 16px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--ink);
      background:
        radial-gradient(1200px 700px at 10% 10%, #ffe0f0 0%, transparent 60%),
        radial-gradient(1000px 700px at 90% 20%, #f0e3ff 0%, transparent 55%),
        radial-gradient(900px 600px at 50% 90%, #e6fff7 0%, transparent 60%),
        linear-gradient(180deg, var(--bg) 0%, #ffffff 100%);
      overflow-x:hidden;
    }

    a{color:inherit}
    .wrap{max-width:1200px;margin:0 auto;padding:28px 18px 70px}

    .hero{
      position:relative;
      border:1px solid var(--line);
      border-radius:var(--radius);
      background: linear-gradient(135deg, #ffffffcc, #fff0f8cc);
      box-shadow:var(--shadow);
      padding:26px 22px;
      overflow:hidden;
    }
    .hero:before{
      content:"";
      position:absolute; inset:-40px -60px auto auto;
      width:280px;height:280px;
      background: radial-gradient(circle at 30% 30%, #ffb3da 0%, transparent 55%),
                  radial-gradient(circle at 70% 70%, #c7b0ff 0%, transparent 55%);
      filter: blur(2px);
      transform: rotate(12deg);
      opacity:.9;
      pointer-events:none;
    }

    h1{
      margin:0 0 8px;
      font-size: clamp(26px, 3vw, 42px);
      letter-spacing:-.02em;
      line-height:1.05;
    }

    .sparkle{
      display:inline-block;
      background: linear-gradient(135deg, var(--pink), var(--lav));
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
      font-weight:950;
    }

    .muted{color:var(--muted)}

    .ctaRow{display:flex;flex-wrap:wrap;gap:10px;margin-top:16px}
    .btn{
      border:1px solid var(--line);
      background: linear-gradient(180deg, #fff, #fff7fb);
      border-radius:999px;
      padding:10px 14px;
      font-weight:750;
      font-size:14px;
      cursor:pointer;
      box-shadow:var(--shadow2);
      transition: transform .08s ease, border-color .2s ease;
      user-select:none;
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      gap:8px;
    }
    .btn:hover{transform: translateY(-1px); border-color:#f0a7cd}
    .btn.primary{
      border-color: transparent;
      background: linear-gradient(135deg, var(--pink), var(--pink2));
      color:white;
    }
    .btn.ghost{background:transparent; box-shadow:none;}

    .grid{margin-top:16px; display:grid; grid-template-columns: 1.2fr .8fr; gap:14px;}
    @media (max-width: 980px){ .grid{grid-template-columns:1fr} }

    .card{
      border:1px solid var(--line);
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow2);
      padding:16px;
      backdrop-filter: blur(8px);
    }

    .card h2{
      margin:0 0 10px;
      font-size:18px;
      letter-spacing:-.01em;
      display:flex; align-items:center; gap:10px;
    }

    .pill{
      font-family:var(--mono);
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background:#fff;
      color:var(--muted);
      white-space:nowrap;
    }

    .kpiRow{display:grid; grid-template-columns:repeat(3, 1fr); gap:10px; margin-top:12px;}
    @media (max-width: 700px){ .kpiRow{grid-template-columns:1fr} }

    .kpi{
      border:1px solid var(--line);
      background:#fff;
      border-radius:var(--radius2);
      padding:12px;
      box-shadow:0 8px 16px rgba(31,22,48,.06);
    }
    .kpi .label{font-size:12px;color:var(--muted);margin-bottom:6px}
    .kpi .value{font-weight:950;font-size:16px}
    .kpi .sub{font-size:12px;color:var(--muted);margin-top:4px;line-height:1.45}

    .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center;}
    select, input[type="date"], input[type="text"]{
      border:1px solid var(--line);
      background:#fff;
      border-radius:14px;
      padding:10px 12px;
      font-weight:700;
      color:var(--ink);
      outline:none;
      box-shadow:0 8px 16px rgba(31,22,48,.06);
    }

    textarea{
      width:100%;
      min-height: 92px;
      border:1px solid var(--line);
      border-radius:18px;
      padding:12px 12px;
      font-family:var(--sans);
      color:var(--ink);
      outline:none;
      background:#fff;
      box-shadow:0 10px 20px rgba(31,22,48,.06);
      resize: vertical;
      line-height:1.5;
    }

    .two{display:grid; grid-template-columns: 1fr 1fr; gap:10px;}
    @media (max-width: 900px){ .two{grid-template-columns:1fr} }

    .chipRow{display:flex; flex-wrap:wrap; gap:8px; margin-top:8px}
    .chip{
      display:inline-flex; align-items:center; gap:8px;
      border:1px solid var(--line);
      background:#fff;
      padding:7px 10px;
      border-radius:999px;
      font-size:12px;
      color:var(--muted);
      box-shadow:0 8px 16px rgba(31,22,48,.05);
    }

    .checkGrid{display:grid; grid-template-columns: repeat(3, 1fr); gap:10px; margin-top:10px;}
    @media (max-width: 900px){ .checkGrid{grid-template-columns:1fr} }

    .checkCard{
      border:1px solid var(--line);
      background:#fff;
      border-radius:18px;
      padding:12px;
      box-shadow:0 10px 20px rgba(31,22,48,.06);
    }
    .checkCard h3{margin:0 0 8px; font-size:14px; letter-spacing:-.01em}

    .checkItem{display:flex; gap:10px; align-items:flex-start; margin:8px 0; color:var(--muted)}
    .checkItem input{margin-top:3px; transform: scale(1.05)}

    .tiny{font-size:12px;color:var(--muted);line-height:1.55}

    .divider{height:1px;background:#f7d8e8;margin:12px 0}

    details{
      border:1px solid var(--line);
      background:#fff;
      border-radius:var(--radius);
      padding:0;
      overflow:hidden;
      box-shadow:var(--shadow2);
    }
    summary{
      list-style:none;
      cursor:pointer;
      padding:14px 16px;
      font-weight:950;
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
    }
    summary::-webkit-details-marker{display:none}
    .caret{
      width:10px;height:10px; border-right:2px solid var(--muted); border-bottom:2px solid var(--muted);
      transform: rotate(-45deg);
      transition:.12s ease;
      margin-left:6px;
    }
    details[open] .caret{transform: rotate(45deg)}
    .content{padding:0 16px 16px; color:var(--muted)}

    .toast{
      position:fixed;
      left:50%;
      bottom:18px;
      transform:translateX(-50%);
      background: linear-gradient(135deg, #ffffff, #fff3fa);
      border:1px solid var(--line);
      border-radius:999px;
      padding:10px 14px;
      box-shadow:var(--shadow);
      display:none;
      font-weight:900;
      z-index:999;
    }

    footer{margin-top:18px;color:var(--muted);font-size:12px;text-align:center}
  </style>
</head>

<body>
  <div class="wrap">

    <header class="hero">
      <h1><span class="sparkle">Schola Arcana</span> ‚Äî Weekly & Daily Log</h1>
      <p class="muted" style="margin:0;max-width:90ch">
        This is your reflection engine. Not therapy. Not vibes. A research log.
        Every entry should leave evidence of thinking: definitions, axioms, confusions, questions, and proof progress.
      </p>

      <div class="ctaRow">
        <a class="btn" href="index.html">‚Üê Back to Cathedral</a>
        <a class="btn" href="vault.html">Proof Vault</a>
        <a class="btn" href="topics.html">Topics Atlas</a>
        <button class="btn primary" id="saveBtn">Save entry</button>
        <button class="btn" id="exportBtn">Export JSON</button>
        <button class="btn ghost" id="resetBtn">Reset form</button>
      </div>

      <div class="kpiRow">
        <div class="kpi">
          <div class="label">Daily rule</div>
          <div class="value">3‚Äì8 lines</div>
          <div class="sub">Just enough to keep continuity. Don‚Äôt write a novel.</div>
        </div>
        <div class="kpi">
          <div class="label">Weekly rule</div>
          <div class="value">1 synthesis paragraph</div>
          <div class="sub">‚ÄúAxioms ‚Üí structures ‚Üí what I can now prove.‚Äù</div>
        </div>
        <div class="kpi">
          <div class="label">Proof culture</div>
          <div class="value">Log 1 proof artifact/week</div>
          <div class="sub">Even if it‚Äôs short. Especially if it‚Äôs short.</div>
        </div>
      </div>
    </header>


    <section class="grid" style="margin-top:16px">

      <div class="card">
        <h2>Entry metadata <span class="pill">minimal + structured</span></h2>

        <div class="row" style="margin-top:10px">
          <input type="date" id="date" />

          <select id="entryType">
            <option value="daily">Daily entry</option>
            <option value="weekly">Weekly synthesis</option>
          </select>

          <select id="week">
            <option value="">Week (optional)</option>
          </select>

          <input type="text" id="session" placeholder="Session (e.g., 'TOC + LA')" style="min-width:240px" />
        </div>

        <div class="divider"></div>

        <div class="two">
          <div>
            <div class="tiny" style="font-weight:900;color:var(--ink);margin-bottom:6px">Mood</div>
            <select id="mood">
              <option value="">‚Äî</option>
              <option>focused</option>
              <option>curious</option>
              <option>confused (productive)</option>
              <option>tired</option>
              <option>stressed</option>
              <option>excited</option>
              <option>unstoppable</option>
            </select>
          </div>

          <div>
            <div class="tiny" style="font-weight:900;color:var(--ink);margin-bottom:6px">Energy</div>
            <select id="energy">
              <option value="">‚Äî</option>
              <option>low</option>
              <option>medium</option>
              <option>high</option>
              <option>feral</option>
            </select>
          </div>
        </div>

        <div class="chipRow">
          <span class="chip">Objects ‚Üí Axioms ‚Üí Goal ‚Üí Invariant</span>
          <span class="chip">Write like a scientist, not like a diary</span>
          <span class="chip">Confusion is data</span>
        </div>

        <div class="divider"></div>

        <h2>Core reflection <span class="pill">the Cathedral loop</span></h2>

        <div class="two">
          <div>
            <div class="tiny" style="font-weight:900;color:var(--ink);margin-bottom:6px">What I learned (theorem/idea)</div>
            <textarea id="learned" placeholder="Example: 'NFAs and DFAs are equivalent via subset construction. The key object is the set of possible NFA states after reading a prefix.'"></textarea>
          </div>

          <div>
            <div class="tiny" style="font-weight:900;color:var(--ink);margin-bottom:6px">What I didn‚Äôt understand (yet)</div>
            <textarea id="confusion" placeholder="Example: 'I still don‚Äôt feel pumping lemma as an intuition; it feels like a hack. Need to revisit why it works structurally.'"></textarea>
          </div>
        </div>

        <div class="two" style="margin-top:10px">
          <div>
            <div class="tiny" style="font-weight:900;color:var(--ink);margin-bottom:6px">Questions I have</div>
            <textarea id="questions" placeholder="Write 1‚Äì5 questions. Real questions, not rhetorical."></textarea>
          </div>

          <div>
            <div class="tiny" style="font-weight:900;color:var(--ink);margin-bottom:6px">What I want to revisit</div>
            <textarea id="revisit" placeholder="Example: 'Revisit quantifiers; redo 6 translation drills. Redo Axler 3.12‚Äì3.16.'"></textarea>
          </div>
        </div>

        <div style="margin-top:10px">
          <div class="tiny" style="font-weight:900;color:var(--ink);margin-bottom:6px">Axioms header ritual (90 seconds)</div>
          <textarea id="axioms" placeholder="Objects: ...\nAxioms/Definitions: ...\nGoal: ...\nInvariant: ..."></textarea>
        </div>

        <div style="margin-top:10px">
          <div class="tiny" style="font-weight:900;color:var(--ink);margin-bottom:6px">Weekly synthesis (only for Weekly entries)</div>
          <textarea id="synthesis" placeholder="Write one paragraph: axioms ‚Üí structures ‚Üí what you can now prove. Mention 1 proof artifact."></textarea>
        </div>

      </div>


      <div class="card">
        <h2>Weekly scoreboard <span class="pill">evidence</span></h2>

        <div class="checkGrid">
          <div class="checkCard">
            <h3>Foundations</h3>
            <label class="checkItem"><input type="checkbox" id="c_toc" /> TOC exercises done</label>
            <label class="checkItem"><input type="checkbox" id="c_axioms" /> Logic/Discrete done</label>
            <label class="checkItem"><input type="checkbox" id="c_proof" /> Proof artifact produced</label>
          </div>

          <div class="checkCard">
            <h3>Structure</h3>
            <label class="checkItem"><input type="checkbox" id="c_axler" /> Axler exercises done</label>
            <label class="checkItem"><input type="checkbox" id="c_struct" /> Summary sheet / key theorem</label>
            <label class="checkItem"><input type="checkbox" id="c_review" /> Review hardest problems</label>
          </div>

          <div class="checkCard">
            <h3>Quantum + Dossier</h3>
            <label class="checkItem"><input type="checkbox" id="c_qc" /> Quantum reps (2‚Äì5)</label>
            <label class="checkItem"><input type="checkbox" id="c_project" /> Project commit</label>
            <label class="checkItem"><input type="checkbox" id="c_dossier" /> Dossier step</label>
          </div>
        </div>

        <div class="divider"></div>

        <h2>Links (optional) <span class="pill">repo evidence</span></h2>
        <div class="tiny" style="font-weight:900;color:var(--ink);margin-bottom:6px">Proof PDF link (GitHub)</div>
        <input type="text" id="proofLink" placeholder="e.g., https://github.com/.../proofs/week07_pumpinglemma.pdf" style="width:100%" />

        <div style="height:10px"></div>
        <div class="tiny" style="font-weight:900;color:var(--ink);margin-bottom:6px">Commit / PR link</div>
        <input type="text" id="commitLink" placeholder="e.g., https://github.com/.../commit/abc123" style="width:100%" />

        <div style="height:10px"></div>
        <div class="tiny" style="font-weight:900;color:var(--ink);margin-bottom:6px">Reading pages (quick)</div>
        <input type="text" id="pages" placeholder="e.g., Sipser 1.4 (p. 70‚Äì84), Axler 3 (p. 55‚Äì76)" style="width:100%" />

        <div class="divider"></div>

        <details open>
          <summary>
            Saved entries
            <span style="display:flex;gap:8px;align-items:center">
              <span class="pill" id="countPill">0</span>
              <span class="caret"></span>
            </span>
          </summary>
          <div class="content">
            <div class="tiny">Your entries are stored locally in your browser (localStorage). This is private to your device.</div>
            <div style="height:10px"></div>
            <div id="entries"></div>
            <div style="height:10px"></div>
            <button class="btn" id="clearAll">Clear all entries</button>
          </div>
        </details>

      </div>

    </section>

    <footer>
      Pink, but rigorous. üíó<br/>
      <span class="muted">Tip: once a week, copy the weekly synthesis into your proof vault as a README note.</span>
    </footer>

  </div>

  <div class="toast" id="toast">Saved ‚ú®</div>

  <script>
    // ---------- helpers ----------
    const $ = (id)=>document.getElementById(id);

    // set default date
    const today = new Date();
    const yyyy = today.getFullYear();
    const mm = String(today.getMonth()+1).padStart(2,'0');
    const dd = String(today.getDate()).padStart(2,'0');
    $("date").value = `${yyyy}-${mm}-${dd}`;

    // populate week dropdown
    const weekSel = $("week");
    for(let i=1;i<=17;i++){
      const opt = document.createElement("option");
      opt.value = String(i);
      opt.textContent = `Week ${i}`;
      weekSel.appendChild(opt);
    }

    // localStorage key
    const KEY = "schola_arcana_log_entries_v1";

    function readAll(){
      try{ return JSON.parse(localStorage.getItem(KEY) || "[]"); }
      catch{ return []; }
    }

    function writeAll(entries){
      localStorage.setItem(KEY, JSON.stringify(entries));
    }

    function toast(msg){
      const t = $("toast");
      t.textContent = msg;
      t.style.display = "block";
      setTimeout(()=>{t.style.display = "none";}, 1100);
    }

    function gather(){
      return {
        id: crypto.randomUUID(),
        date: $("date").value,
        entryType: $("entryType").value,
        week: $("week").value,
        session: $("session").value.trim(),
        mood: $("mood").value,
        energy: $("energy").value,

        learned: $("learned").value.trim(),
        confusion: $("confusion").value.trim(),
        questions: $("questions").value.trim(),
        revisit: $("revisit").value.trim(),
        axioms: $("axioms").value.trim(),
        synthesis: $("synthesis").value.trim(),

        checks: {
          toc: $("c_toc").checked,
          axioms: $("c_axioms").checked,
          proof: $("c_proof").checked,
          axler: $("c_axler").checked,
          struct: $("c_struct").checked,
          review: $("c_review").checked,
          qc: $("c_qc").checked,
          project: $("c_project").checked,
          dossier: $("c_dossier").checked,
        },

        links: {
          proof: $("proofLink").value.trim(),
          commit: $("commitLink").value.trim(),
          pages: $("pages").value.trim(),
        },

        createdAt: new Date().toISOString(),
      };
    }

    function validate(entry){
      if(!entry.date) return "Pick a date.";
      if(!entry.learned && !entry.confusion && !entry.questions && !entry.revisit && !entry.synthesis){
        return "Write at least one field (learned/confusion/questions/revisit/synthesis).";
      }
      if(entry.entryType === "weekly" && !entry.week){
        return "Weekly synthesis entries should include the week number.";
      }
      return null;
    }

    function resetForm(){
      $("session").value = "";
      $("mood").value = "";
      $("energy").value = "";
      $("learned").value = "";
      $("confusion").value = "";
      $("questions").value = "";
      $("revisit").value = "";
      $("axioms").value = "";
      $("synthesis").value = "";
      $("proofLink").value = "";
      $("commitLink").value = "";
      $("pages").value = "";

      ["c_toc","c_axioms","c_proof","c_axler","c_struct","c_review","c_qc","c_project","c_dossier"].forEach(id=>$(id).checked=false);
    }

    function escapeHtml(s){
      return (s||"")
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    function renderEntries(){
      const all = readAll();
      const box = $("entries");
      const pill = $("countPill");
      pill.textContent = String(all.length);

      if(all.length === 0){
        box.innerHTML = `<div class="tiny">No entries yet. Your first entry is the beginning of the Cathedral.</div>`;
        return;
      }

      // newest first
      const sorted = [...all].sort((a,b)=> (b.date||"").localeCompare(a.date||""));

      box.innerHTML = sorted.slice(0, 18).map(e=>{
        const tag = e.entryType === "weekly" ? "Weekly" : "Daily";
        const w = e.week ? ` ¬∑ W${escapeHtml(e.week)}` : "";
        const title = `${escapeHtml(e.date)} ¬∑ ${tag}${w}`;

        const learned = e.learned ? `<div class="tiny"><b style="color:var(--ink)">Learned:</b> ${escapeHtml(e.learned).slice(0, 120)}${e.learned.length>120?"‚Ä¶":""}</div>` : "";
        const conf = e.confusion ? `<div class="tiny"><b style="color:var(--ink)">Confusion:</b> ${escapeHtml(e.confusion).slice(0, 120)}${e.confusion.length>120?"‚Ä¶":""}</div>` : "";

        return `
          <div style="border:1px solid #f7d8e8;background:#fff;border-radius:18px;padding:12px;box-shadow:0 10px 20px rgba(31,22,48,.05);margin-bottom:10px">
            <div style="display:flex;justify-content:space-between;gap:10px;align-items:flex-start">
              <div style="font-weight:950">${title}</div>
              <button class="btn" style="padding:8px 10px;font-size:12px" onclick="deleteEntry('${e.id}')">Delete</button>
            </div>
            <div class="muted" style="font-size:12px;margin-top:6px">${escapeHtml(e.session||"")}</div>
            <div style="margin-top:8px">${learned}${conf}</div>
          </div>
        `;
      }).join("");
    }

    // global for onclick
    window.deleteEntry = function(id){
      const all = readAll();
      const next = all.filter(e=>e.id !== id);
      writeAll(next);
      renderEntries();
      toast("Deleted");
    }

    // ---------- actions ----------
    $("saveBtn").addEventListener("click", ()=>{
      const entry = gather();
      const err = validate(entry);
      if(err){ toast(err); return; }

      const all = readAll();
      all.push(entry);
      writeAll(all);
      renderEntries();
      toast("Saved ‚ú®");

      // if daily, keep momentum: don't reset date/type/week
      resetForm();
    });

    $("resetBtn").addEventListener("click", ()=>{
      resetForm();
      toast("Reset");
    });

    $("clearAll").addEventListener("click", ()=>{
      if(!confirm("Clear all entries? This cannot be undone.")) return;
      writeAll([]);
      renderEntries();
      toast("Cleared");
    });

    $("exportBtn").addEventListener("click", ()=>{
      const all = readAll();
      const blob = new Blob([JSON.stringify(all, null, 2)], {type:"application/json"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "schola_arcana_log_export.json";
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
      toast("Exported");
    });

    // render on load
    renderEntries();

    // quality-of-life: if entryType weekly, nudge week selection
    $("entryType").addEventListener("change", ()=>{
      if($("entryType").value === "weekly" && !$("week").value){
        $("week").value = "1";
      }
    });
  </script>
</body>
</html>
